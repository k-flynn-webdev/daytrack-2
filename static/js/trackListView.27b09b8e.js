(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["trackListView"],{a5aa:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column is-11"},[a("track-create"),t.isLoggedIn?a("track-list"):a("div",[t._v("Not logged in")])],1)},s=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track-create bubble"},[a("form",{staticClass:"track",on:{reset:function(e){return e.preventDefault(),t.onReset(e)},submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("div",{staticClass:"field"},[a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.track,expression:"form.track"}],staticClass:"input",attrs:{id:"id-track-input",type:"text",placeholder:"..What happened?",required:""},domProps:{value:t.form.track},on:{input:function(e){e.target.composing||t.$set(t.form,"track",e.target.value)}}})])]),a("div",{staticClass:"track-create__tag"},[a("div",{staticClass:"track-create__tag__row"},[t._l(t.form.tags,(function(e){return a("tag-item",{key:e.value,attrs:{tag:e,"allow-url":!1,"allow-info":!1},on:{click:function(a){return t.onTagRemove(e)}}})})),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tagInput,expression:"tagInput"}],staticClass:"track-create__tag__row-text input",attrs:{type:"text",placeholder:"..#Tags"},domProps:{value:t.tagInput},on:{blur:t.onTagAdd,keydown:[function(e){return e.type.indexOf("key")||32===e.keyCode?t.onTagAdd(e):null},function(e){return e.type.indexOf("key")||188===e.keyCode?t.onTagAdd(e):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onTagAdd(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.onTagRemove(e)}],input:function(e){e.target.composing||(t.tagInput=e.target.value)}}})],2),a("button",{staticClass:"button-add bubble",attrs:{type:"submit"}},[t._v("\n        "+t._s(t.loading?"...":"Add")+"\n      ")])])]),a("tags-recent",{on:{tagAdd:t.onTagAdd}})],1)},r=[],c=a("5a50"),l=a("c0dc"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tag bubble is-clickable",on:{click:t.onClick}},[a("span",{staticClass:"value"},[t._v(t._s(t.tag.value))]),t.allowInfo?a("div",{staticClass:"tag-info"},[a("div",[t._v("created: "+t._s(t._f("itemDate")(t.tag)))]),a("div",[t._v("used: "+t._s(t.tag.count_all))])]):t._e()])},u=[],g=(a("7f7f"),{name:"tag-item",props:{tag:{type:Object,default:c["e"].default()},allowUrl:{type:Boolean,default:!0},allowInfo:{type:Boolean,default:!0}},methods:{onClick:function(){if(!this.allowUrl)return this.$emit("click",this.tag);this.$router.push({name:c["e"].route.name,params:{tag:this.tag.value}})}}}),d=g,f=a("2877"),m=Object(f["a"])(d,o,u,!1,null,null,null),k=m.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tag-list recent"},[a("div",{staticClass:"tag-list-content"},[a("span",{staticClass:"label is-size-6 is-clickable",on:{click:t.getRecentTags}},[t._v("\n      Recent:\n    ")]),t._l(t.recentTags,(function(e){return a("tag-item",{key:e.id,attrs:{tag:e,"allow-url":!1,"allow-info":!1},on:{click:function(a){return t.onClick(e)}}})}))],2)])},h=[],p={name:"tags-recent",components:{tagItem:k},data:function(){return{recentTags:[]}},created:function(){return this.getRecentTags()},methods:{getRecentTags:function(){var t=this;return l["a"].get(c["e"].API.GET,{params:{limit:5}}).then((function(e){var a=e.data;t.recentTags=a.results})).catch((function(t){}))},onClick:function(t){this.$emit("tagAdd",t);for(var e=0,a=this.recentTags.length;e<a;e++)if(this.recentTags[e].value===t.value)return void this.recentTags.splice(e,1)}}},_=p,b=Object(f["a"])(_,v,h,!1,null,null,null),C=b.exports,T={name:"track-create",components:{tagItem:k,tagsRecent:C},data:function(){return{tagInput:"",loading:!1,form:{track:"",tags:[]}}},created:function(){var t=this;return this.getToken().then((function(){return t.onReset()}))},methods:{getToken:function(){return l["a"].get(c["a"].API.GET)},checkTagExists:function(t){for(var e=0;e<this.form.tags.length;e++)if(this.form.tags[e].value===t)return!0;return!1},onTagAdd:function(t){if(t.id&&t.value){if(this.checkTagExists(t.value))return;this.form.tags.push(t)}else{t.preventDefault();var e=t.target.value.trim();if(e.length>0){if(this.checkTagExists(e))return;this.form.tags.push({value:e}),this.tagInput="",t.target.value=""}}},onTagRemove:function(t){if(t.value)for(var e=0;e<this.form.tags.length;e++)if(this.form.tags[e].value===t.value)return void this.form.tags.splice(e,1);this.form.tags.length>0&&t&&t.target&&t.target.value.length<1&&this.form.tags.splice(this.form.tags.length-1,1)},onReset:function(){this.tagInput="",this.form.track="",this.form.tags=[]},onSubmit:function(){var t=this;if(!this.loading&&c["f"].isValid(this.form))return this.loading=!0,this.$store.dispatch("track/post",{track:this.form.track,tags:this.form.tags.map((function(t){return t.id?t:t.value}))}).then((function(){t.onReset(),t.getToken()})).catch((function(t){})).finally((function(){return t.loading=!1}))}}},y=T,w=Object(f["a"])(y,i,r,!1,null,null,null),x=w.exports,I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track-list"},[!t.loading&&t.getTrackList?t._l(t.trackList,(function(t){return a("track-item",{key:t.id,attrs:{track:t}})})):t.loading?a("div",[t._v("\n    Loading\n  ")]):!t.loading&&t.trackList.length<1?a("div",[t._v("\n    No Tracks\n  ")]):t._e()],2)},$=[],L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track",class:t.trackDateClass},[a("div",{staticClass:"track__body bubble",class:{"has-tags":t.track.tags.length>0}},[t._v("\n    "+t._s(t.track.value)+"\n\n    "),a("div",{staticClass:"track__body-time is-size-7"},[t._v("\n      "+t._s(t._f("tagDate")(t.track))+"\n    ")])]),a("div",{staticClass:"tag-list"},[a("div",{staticClass:"tag-list-content"},t._l(t.track.tags,(function(t){return a("tag-item",{key:t.id,attrs:{tag:t}})})),1)])])},E=[],O={name:"track-item",components:{tagItem:k},props:{track:{type:Object,default:c["f"].default()}},computed:{trackDateClass:function(){var t=new Date(this.track.created_at).getDate();return t%2===1?"is-light":null}}},R=O,A=Object(f["a"])(R,L,E,!1,null,null,null),D=A.exports,j={name:"track-list",components:{trackItem:D},data:function(){return{loading:!1}},computed:{trackList:function(){return this.$store.state[c["f"].store].trackList}},created:function(){return this.getTrackList()},methods:{getTrackList:function(){var t=this;if(!this.loading)return this.loading=!0,this.$store.dispatch("track/get").finally((function(){return t.loading=!1}))}}},N=j,P=Object(f["a"])(N,I,$,!1,null,null,null),B=P.exports,z={name:"track-list-view",components:{trackCreate:x,trackList:B},computed:{isLoggedIn:function(){return this.$store.state[c["g"].store].isLoggedIn}}},G=z,J=Object(f["a"])(G,n,s,!1,null,null,null);e["default"]=J.exports}}]);
//# sourceMappingURL=trackListView.27b09b8e.js.map