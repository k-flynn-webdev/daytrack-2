(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["trackListView"],{a5aa:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column is-11"},[a("track-create"),t.isLoggedIn?a("track-list"):a("div",[t._v("Not logged in")])],1)},s=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track-create bubble"},[a("form",{staticClass:"track",on:{reset:function(e){return e.preventDefault(),t.onReset(e)},submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("div",{staticClass:"field"},[a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.track,expression:"form.track"}],staticClass:"input",attrs:{id:"id-track-input",type:"text",required:"",placeholder:"..What happened?"},domProps:{value:t.form.track},on:{input:[function(e){e.target.composing||t.$set(t.form,"track",e.target.value)},function(e){return t.$store.dispatch("api/getCSRF")}]}})])]),a("div",{staticClass:"track-create__tag"},[a("div",{staticClass:"track-create__tag__row"},[t._l(t.form.tags,(function(e){return a("tag-item",{key:e.value,attrs:{"show-close":"",tag:e,"allow-url":!1,"allow-info":!1},on:{click:function(a){return t.onTagRemove(e)}}})})),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tagInput,expression:"tagInput"}],staticClass:"track-create__tag__row-text input",attrs:{type:"text",placeholder:"..#Tags"},domProps:{value:t.tagInput},on:{blur:t.onTagAdd,input:[function(e){e.target.composing||(t.tagInput=e.target.value)},function(e){return t.$store.dispatch("api/getCSRF")}],keydown:[function(e){return e.type.indexOf("key")||32===e.keyCode?t.onTagAdd(e):null},function(e){return e.type.indexOf("key")||188===e.keyCode?t.onTagAdd(e):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onTagAdd(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.onTagRemove(e)}]}})],2),a("button",{staticClass:"button-add bubble has-fill-white icon ml-1",class:{"is-loading":t.loading},attrs:{disabled:t.loading||!t.isValid,type:"submit"}},[a("right-icon")],1)])]),a("tags-recent",{on:{tagAdd:t.onTagAdd}})],1)},r=[],l=a("5a50"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("svg",{staticClass:"icon",class:t.classItems,staticStyle:{"fill-rule":"evenodd","clip-rule":"evenodd","stroke-linejoin":"round","stroke-miterlimit":"2"},attrs:{viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xml:space":"preserve","xmlns:serif":"http://www.serif.com/"}},[a("path",{attrs:{d:"M428.725,256l-345.45,-234.449l0,468.898l345.45,-234.449Z"}})])},c=[],u={name:"right-icon",props:{classItems:{type:String,default:""}}},d=u,g=a("2877"),f=Object(g["a"])(d,o,c,!1,null,null,null),m=f.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tag bubble is-clickable",class:{"show-close":t.showClose},on:{click:t.onClick}},[a("span",{staticClass:"value"},[t._v(t._s(t.tag.value))]),t.allowInfo?a("div",{staticClass:"tag-info"},[a("div",[t._v("created: "+t._s(t._f("itemDate")(t.tag)))]),a("div",[t._v("used: "+t._s(t.tag.count_all))])]):t._e(),t.showClose?a("cross-icon"):t._e()],1)},p=[],v=(a("7f7f"),a("41d4")),k={name:"tag-item",components:{crossIcon:v["a"]},props:{tag:{type:Object,default:l["e"].default()},allowUrl:{type:Boolean,default:!0},allowInfo:{type:Boolean,default:!0},showClose:{type:Boolean,default:!1}},methods:{onClick:function(){if(!this.allowUrl)return this.$emit("click",this.tag);this.$router.push({name:l["e"].route.name,params:{tag:this.tag.value}})}}},_=k,w=Object(g["a"])(_,h,p,!1,null,null,null),C=w.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tag-list recent"},[a("div",{staticClass:"tag-list-content"},[a("span",{staticClass:"label is-size-6 is-clickable",on:{click:t.getRecentTags}},[t._v("\n      Recent:\n    ")]),t._l(t.recentTags,(function(e){return a("tag-item",{key:e.id,attrs:{tag:e,"allow-url":!1,"allow-info":!1},on:{click:function(a){return t.onClick(e)}}})}))],2)])},y=[],T=a("c0dc"),x=a("8fbf"),I={name:"tags-recent",mixins:[x["a"]],components:{tagItem:C},data:function(){return{recentTags:[]}},created:function(){return this.getRecentTags()},methods:{getRecentTags:function(){var t=this;return T["a"].get(l["e"].API.GET,{params:{limit:5}}).then((function(e){var a=e.data;t.recentTags=a.results})).catch((function(e){return t.handleError(e)}))},onClick:function(t){this.$emit("tagAdd",t);for(var e=0,a=this.recentTags.length;e<a;e++)if(this.recentTags[e].value===t.value)return void this.recentTags.splice(e,1)}}},$=I,R=Object(g["a"])($,b,y,!1,null,null,null),D=R.exports,L={name:"track-create",mixins:[x["a"]],components:{rightIcon:m,tagItem:C,tagsRecent:D},data:function(){return{tagInput:"",loading:!1,form:{track:"",tags:[]}}},computed:{isValid:function(){return l["f"].isValid(this.form)}},created:function(){this.onReset()},methods:{isDuplicateTag:function(t){for(var e=0;e<this.form.tags.length;e++)if(this.form.tags[e].value===t)return!0;return!1},onTagAdd:function(t){if(t.id&&t.value){if(this.isDuplicateTag(t.value))return;this.form.tags.push(t)}else{t.preventDefault();var e=t.target.value.trim();if(e.length>0){if(this.isDuplicateTag(e))return;this.form.tags.push({value:e}),this.tagInput="",t.target.value=""}}},onTagRemove:function(t){if(t.value)for(var e=0;e<this.form.tags.length;e++)if(this.form.tags[e].value===t.value)return void this.form.tags.splice(e,1);this.form.tags.length>0&&t&&t.target&&t.target.value.length<1&&this.form.tags.splice(this.form.tags.length-1,1)},onReset:function(){this.tagInput="",this.form=this.$options.data.call(this).form},onSubmit:function(){var t=this;if(!this.loading&&l["f"].isValid(this.form))return this.loading=!0,this.$store.dispatch("api/getCSRF").then((function(){return t.$store.dispatch("track/post",{track:t.form.track,tags:t.form.tags.map((function(t){return t.id?t:t.value}))})})).then((function(){return t.onReset()})).catch((function(e){return t.handleError(e)})).finally((function(){return t.loading=!1}))}}},O=L,E=Object(g["a"])(O,i,r,!1,null,null,null),j=E.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track-list"},[!t.loading&&t.getTrackList?t._l(t.trackList,(function(t){return a("track-item",{key:t.id,attrs:{track:t}})})):t.loading?a("div",[t._v("\n    Loading\n  ")]):!t.loading&&t.trackList.length<1?a("div",[t._v("\n    No Tracks\n  ")]):t._e()],2)},S=[],B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track",class:t.trackDateClass},[a("div",{staticClass:"track__body bubble",class:{"has-tags":t.track.tags.length>0}},[t._v("\n    "+t._s(t.track.value)+"\n\n    "),a("div",{staticClass:"track__body-time is-size-7"},[t._v("\n      "+t._s(t._f("tagDate")(t.track))+"\n    ")])]),a("div",{staticClass:"tag-list"},[a("div",{staticClass:"tag-list-content"},t._l(t.track.tags,(function(t){return a("tag-item",{key:t.id,attrs:{tag:t}})})),1)])])},V=[],N={name:"track-item",components:{tagItem:C},props:{track:{type:Object,default:l["f"].default()}},computed:{trackDateClass:function(){var t=new Date(this.track.created_at).getDate();return t%2===1?"is-light":null}}},F=N,P=Object(g["a"])(F,B,V,!1,null,null,null),z=P.exports,J={name:"track-list",mixins:[x["a"]],components:{trackItem:z},data:function(){return{loading:!1}},computed:{trackList:function(){return this.$store.state[l["f"].store].trackList}},created:function(){return this.getTrackList()},methods:{getTrackList:function(){var t=this;if(!this.loading)return this.loading=!0,this.$store.dispatch("track/get").catch((function(e){return t.handleError(e)})).finally((function(){return t.loading=!1}))}}},U=J,q=Object(g["a"])(U,A,S,!1,null,null,null),G=q.exports,M={name:"track-list-view",components:{trackCreate:j,trackList:G},computed:{isLoggedIn:function(){return this.$store.state[l["g"].store].isLoggedIn}}},W=M,Z=Object(g["a"])(W,n,s,!1,null,null,null);e["default"]=Z.exports}}]);
//# sourceMappingURL=trackListView.c3c9d5e6.js.map