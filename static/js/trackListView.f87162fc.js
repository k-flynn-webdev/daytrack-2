(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["trackListView"],{a5aa:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column is-11"},[a("track-create"),t.isLoggedIn?a("track-list"):a("div",[t._v("Not logged in")])],1)},i=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track-create bubble"},[a("form",{staticClass:"track",on:{reset:function(e){return e.preventDefault(),t.onReset(e)},submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("div",{staticClass:"field"},[a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.track,expression:"form.track"}],staticClass:"input",attrs:{id:"id-track-input",type:"text",placeholder:"..What happened?",required:""},domProps:{value:t.form.track},on:{input:function(e){e.target.composing||t.$set(t.form,"track",e.target.value)}}})])]),a("div",{staticClass:"track-create__tag"},[a("div",{staticClass:"track-create__tag__row"},[t._l(t.form.tags,(function(e){return a("tag-item",{key:e.value,attrs:{tag:e,"allow-url":!1,"allow-info":!1},on:{click:function(a){return t.onTagRemove(e)}}})})),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tagInput,expression:"tagInput"}],staticClass:"track-create__tag__row-text input",attrs:{type:"text",placeholder:"..#Tags"},domProps:{value:t.tagInput},on:{blur:t.onTagAdd,keydown:[function(e){return e.type.indexOf("key")||32===e.keyCode?t.onTagAdd(e):null},function(e){return e.type.indexOf("key")||188===e.keyCode?t.onTagAdd(e):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onTagAdd(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.onTagRemove(e)}],input:function(e){e.target.composing||(t.tagInput=e.target.value)}}})],2),a("button",{staticClass:"button-add bubble has-fill-white pl-2 pr-1",class:{"is-loading":t.loading},attrs:{disabled:t.loading||!t.isValid,type:"submit"}},[a("svg",{staticStyle:{"fill-rule":"evenodd","clip-rule":"evenodd","stroke-linejoin":"round","stroke-miterlimit":"2"},attrs:{viewBox:"0 0 512 512",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xml:space":"preserve","xmlns:serif":"http://www.serif.com/"}},[a("path",{attrs:{d:"M428.725,256l-345.45,-234.449l0,468.898l345.45,-234.449Z"}})])])])]),a("tags-recent",{on:{tagAdd:t.onTagAdd}})],1)},r=[],l=a("5a50"),o=a("c0dc"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tag bubble is-clickable",on:{click:t.onClick}},[a("span",{staticClass:"value"},[t._v(t._s(t.tag.value))]),t.allowInfo?a("div",{staticClass:"tag-info"},[a("div",[t._v("created: "+t._s(t._f("itemDate")(t.tag)))]),a("div",[t._v("used: "+t._s(t.tag.count_all))])]):t._e()])},u=[],g=(a("7f7f"),{name:"tag-item",props:{tag:{type:Object,default:l["e"].default()},allowUrl:{type:Boolean,default:!0},allowInfo:{type:Boolean,default:!0}},methods:{onClick:function(){if(!this.allowUrl)return this.$emit("click",this.tag);this.$router.push({name:l["e"].route.name,params:{tag:this.tag.value}})}}}),d=g,f=a("2877"),m=Object(f["a"])(d,c,u,!1,null,null,null),h=m.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tag-list recent"},[a("div",{staticClass:"tag-list-content"},[a("span",{staticClass:"label is-size-6 is-clickable",on:{click:t.getRecentTags}},[t._v("\n      Recent:\n    ")]),t._l(t.recentTags,(function(e){return a("tag-item",{key:e.id,attrs:{tag:e,"allow-url":!1,"allow-info":!1},on:{click:function(a){return t.onClick(e)}}})}))],2)])},k=[],p=a("8fbf"),_={name:"tags-recent",mixins:[p["a"]],components:{tagItem:h},data:function(){return{recentTags:[]}},created:function(){return this.getRecentTags()},methods:{getRecentTags:function(){var t=this;return o["a"].get(l["e"].API.GET,{params:{limit:5}}).then((function(e){var a=e.data;t.recentTags=a.results})).catch((function(e){return t.handleError(e)}))},onClick:function(t){this.$emit("tagAdd",t);for(var e=0,a=this.recentTags.length;e<a;e++)if(this.recentTags[e].value===t.value)return void this.recentTags.splice(e,1)}}},b=_,w=Object(f["a"])(b,v,k,!1,null,null,null),C=w.exports,y={name:"track-create",mixins:[p["a"]],components:{tagItem:h,tagsRecent:C},data:function(){return{tagInput:"",loading:!1,form:{track:"",tags:[]}}},computed:{isValid:function(){return l["f"].isValid(this.form)}},created:function(){var t=this;return this.getToken().then((function(){return t.onReset()}))},methods:{getToken:function(){return o["a"].get(l["a"].API.GET)},checkTagExists:function(t){for(var e=0;e<this.form.tags.length;e++)if(this.form.tags[e].value===t)return!0;return!1},onTagAdd:function(t){if(t.id&&t.value){if(this.checkTagExists(t.value))return;this.form.tags.push(t)}else{t.preventDefault();var e=t.target.value.trim();if(e.length>0){if(this.checkTagExists(e))return;this.form.tags.push({value:e}),this.tagInput="",t.target.value=""}}},onTagRemove:function(t){if(t.value)for(var e=0;e<this.form.tags.length;e++)if(this.form.tags[e].value===t.value)return void this.form.tags.splice(e,1);this.form.tags.length>0&&t&&t.target&&t.target.value.length<1&&this.form.tags.splice(this.form.tags.length-1,1)},onReset:function(){this.tagInput="",this.form.track="",this.form.tags=[]},onSubmit:function(){var t=this;if(!this.loading&&l["f"].isValid(this.form))return this.loading=!0,this.$store.dispatch("track/post",{track:this.form.track,tags:this.form.tags.map((function(t){return t.id?t:t.value}))}).then((function(){t.onReset(),t.getToken()})).catch((function(e){return t.handleError(e)})).finally((function(){return t.loading=!1}))}}},T=y,x=Object(f["a"])(T,s,r,!1,null,null,null),I=x.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track-list"},[!t.loading&&t.getTrackList?t._l(t.trackList,(function(t){return a("track-item",{key:t.id,attrs:{track:t}})})):t.loading?a("div",[t._v("\n    Loading\n  ")]):!t.loading&&t.trackList.length<1?a("div",[t._v("\n    No Tracks\n  ")]):t._e()],2)},$=[],L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"track",class:t.trackDateClass},[a("div",{staticClass:"track__body bubble",class:{"has-tags":t.track.tags.length>0}},[t._v("\n    "+t._s(t.track.value)+"\n\n    "),a("div",{staticClass:"track__body-time is-size-7"},[t._v("\n      "+t._s(t._f("tagDate")(t.track))+"\n    ")])]),a("div",{staticClass:"tag-list"},[a("div",{staticClass:"tag-list-content"},t._l(t.track.tags,(function(t){return a("tag-item",{key:t.id,attrs:{tag:t}})})),1)])])},O=[],R={name:"track-item",components:{tagItem:h},props:{track:{type:Object,default:l["f"].default()}},computed:{trackDateClass:function(){var t=new Date(this.track.created_at).getDate();return t%2===1?"is-light":null}}},D=R,A=Object(f["a"])(D,L,O,!1,null,null,null),j=A.exports,V={name:"track-list",mixins:[p["a"]],components:{trackItem:j},data:function(){return{loading:!1}},computed:{trackList:function(){return this.$store.state[l["f"].store].trackList}},created:function(){return this.getTrackList()},methods:{getTrackList:function(){var t=this;if(!this.loading)return this.loading=!0,this.$store.dispatch("track/get").catch((function(e){return t.handleError(e)})).finally((function(){return t.loading=!1}))}}},B=V,N=Object(f["a"])(B,E,$,!1,null,null,null),P=N.exports,S={name:"track-list-view",components:{trackCreate:I,trackList:P},computed:{isLoggedIn:function(){return this.$store.state[l["g"].store].isLoggedIn}}},z=S,G=Object(f["a"])(z,n,i,!1,null,null,null);e["default"]=G.exports}}]);
//# sourceMappingURL=trackListView.f87162fc.js.map